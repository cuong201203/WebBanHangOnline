
@{
    ViewBag.Title = "Giỏ hàng";
}

<link rel="stylesheet" type="text/css" href="~/Content/assets/styles/whole_web_styles.css">
<link rel="stylesheet" type="text/css" href="~/Content/assets/styles/whole_web_responsive.css">

<div class="container product_section_container">
    <div class="row">
        <div class="col product_section clearfix">

            <!-- Breadcrumbs -->

            <div class="breadcrumbs d-flex flex-row align-items-center">
                <ul>
                    <li><a href="/">Trang chủ</a></li>
                    <li class="active"><a href="#"><i class="fa fa-angle-right" aria-hidden="true"></i>Giỏ hàng</a></li>
                </ul>
            </div>

            <h2 id="title">@ViewBag.Title</h2>

            <!-- Main Content -->

            <div class="row">
                <div class="col-md-12" id="load_data">
                    @Html.Action("Partial_ItemCart", "ShoppingCart")
                </div>
                <div class="col-md-12">
                    @if (ViewBag.CheckCart == true)
                    {
                    <div class="text-right">
                        <a href="#" class="btn btn-sm btn-danger btnDeleteAll">Xóa hết</a>
                        <a href="#" class="btn btn-sm btn-success btnCheckOut">Thanh toán</a>
                    </div>
                    }
                </div>
            </div>
        </div>
    </div>
</div>

<script>
    $('.btnCheckOut').on('click', function (e) {
        e.preventDefault();
        var selectedProductIds = [];
        $('.cbkItem:checked').each(function () {
            selectedProductIds.push($(this).val());
        });

        if (selectedProductIds.length === 0) {
            alert("Vui lòng chọn sản phẩm để thanh toán!");
            return;
        }

        $.ajax({
            type: 'POST',
            url: '@Url.Action("Partial_ItemCheckOut", "ShoppingCart")',
            data: { selectedProductIds: selectedProductIds },
            success: function (response) {
                if (response.success) {
                    window.location.href = '/thanh-toan';
                } else {
                    alert(response.message);
                }
            },
            error: function () {
                alert("Lỗi khi lưu ID các sản phẩm được chọn.");
            }
        });
    });
</script>
